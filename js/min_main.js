"use strict";!function(){const e=document.querySelector(".theme__list"),t=document.querySelector("template");let n=t.content.querySelector(".main__box--question"),o=t.content.querySelector(".question__answer");const r=t.content.querySelector(".theme__result"),l=document.querySelector(".main__title"),c=document.querySelector(".main__box");let u=document.querySelector(".main");function i(e,t,n){const o=m(e);if(o){let e=r.cloneNode(!0);e.querySelector(".theme__result--ratio").textContent=`${o}/${n}`,t.append(e)}}function a(t){e.textContent="";!function t(n,o){let r=n[o].theme,l=n[o].id,c=n[o].list.length,u=document.createElement("li");u.className="theme__item";let a=document.createElement("button");a.className="btn btn--theme",a.dataset.id=l,a.textContent=r,u.append(a),i(l,u,c),setTimeout(function(){d(u),e.append(u),++o<c-1&&t(n,o)},300)}(t,0)}function s(e,t,n){const o=[];return t.forEach((t,r)=>{"radio"===e?o.push([t,!r]):o.push([t,r<n])}),function(e){const t=[...e];for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}(o)}function d(e){let t=0;e.opacity=t,e.style.display="",function n(){t+=.05,e.style.opacity=t,t<1&&requestAnimationFrame(n)}()}function m(e){return localStorage.getItem(e)}function p(e,r,a){let y=n.cloneNode(!0),f=y.querySelector(".form__question"),q=y.querySelector(".question__title"),h=y.querySelector(".question"),S=y.querySelector(".question__answer"),x=r.list[e],g=r.list.length,b=x.type;q.textContent=x.question,f.dataset.count=`${e+1}/${g}`;let w=[],C=[];s(b,x.answers,x.correct).forEach((e,t)=>{let n=function(e,t,n){let r=o.cloneNode(!0);r.textContent=e;let l=document.createElement("input");return l.className="answer__"+t,l.type=t,l.name="answer",l.value=n,r.append(l),r}(e[0],b,t);h.append(n),w.push(n),C.push(e[1])});const E=C;S.remove(),d(y),u.append(y),f.addEventListener("submit",function(n){n.preventDefault();let o=!1;const s=[...f.querySelectorAll("input")].map(e=>(e.checked&&(o=!0),!!e.checked&&e.value));o?(s.every((e,t)=>!!e===E[t])&&a++,++e<g?_(y,()=>p(e,r,a)):_(y,function(){!function(e,n){let o=t.content.querySelector(".main__box--result").cloneNode(!0),r=o.querySelector(".result__ratio"),a=o.querySelector(".result__text");r.textContent=`${e}/${n.list.length}`;let s=e/n.list.length*100;const p={0:"bad",1:"medium",2:"excellent"};s<n.result[0][0]&&(a.textContent="Не расстраивайся, в следующий раз точно получится!"),n.result.forEach((e,t)=>{s>=e[0]&&(a.textContent=e[1],r.classList.add("result__ratio--"+p[t]))}),d(o),u.append(o),o.querySelector(".btn--result").addEventListener("click",function(){_(o,function(){d(l),d(c)});const e=m(n.id);[...c.querySelectorAll(".btn--theme")].forEach(t=>{if(+t.dataset.id==+n.id){let o=t.parentNode.querySelector(".theme__result--ratio");o?o.textContent=`${e}/${n.list.length}`:i(n.id,t.parentNode,n.list.length)}})})}(a,r),function(e,t){localStorage.setItem(t,e)}(a,r.id)})):(f.classList.add("form__question--error"),setTimeout(()=>f.classList.remove("form__question--error"),1e3))})}function _(e,t){let n=getComputedStyle(e).getPropertyValue("opacity");!function o(){n-=.05,e.style.opacity=n,n>0?requestAnimationFrame(o):(e.style.display="none",t&&t())}()}window.backend.getData(a),e.addEventListener("click",function(e){var t;window.backend.AppData.forEach(n=>{n.theme===e.target.textContent&&(t=n,_(c,()=>p(0,t,0)),_(l))})}),window.main={template:t,mainBox:c}}();